name: Running
on:
  push:
    branches:
      - main
jobs:
  Alerts:
    runs-on: ubuntu-latest
    steps:
    - name: Configure AWS credentials for CLC Production
      uses: aws-actions/configure-aws-credentials@v1
      with:
        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        aws-region: "ap-south-1"
    - name: Downloading aws retriever
      run: |
        mkdir -p awsRetriever
        cd awsRetriever
        sudo apt-get install mono-complete -y
        wget https://github.com/dtylman/AWSRetriever/releases/download/rc3/AWSRetriever_0_1_0_14.zip
        unzip AWSRetriever_0_1_0_14.zip
        cd AWSRetriever_0_1_0_14
        #mono AWSRetriever.exe -r -p default.profile.js -o objects.json
        #cat objects.json
        cd ..
        git clone https://github.com/drugo76/json2csv.git
        sudo apt-get install pip3 -y
        pip3 install python3
        cd json2csv
        python3 json2csv.py -i ../AWSRetriever_0_1_0_14/objects.json -o file.csv
        ls

